<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">

	<title></title>
</head>

<body class="bg-light">

	<!--------------------------------------------------------------------------------------------------->

	<div class="bg-dark p-2 text-center shadow fixed-top">
		<p class="text-white mb-0">Meteo</p>
	</div>

	<br><br><br>

	<!--------------------------------------------------------------------------------------------------->

	<div class="bg-light p-4 container shadow rounded">
		<div class="row">
			<div class="row col-sm-6">
				<div class="col-sm-auto">
					<img style="width: 88px;" class="img-fluid" src="{{weather.icon}}">
				</div>
				<div class="col-sm-auto">
					<p class="mb-0 fw-bolder" style="font-size: 3.3rem;">{{weather.temperature}} C°</p>
				</div>
				<div class="col-sm-auto">
					<p class="mb-0">Précipitations : {{weather.precipitation}} mm</p>
					<p class="mb-0">Humidité : {{weather.humidite}}%</p>
					<p class="mb-0">{{weather.description}}</p>
				</div>
			</div>
			<div class="col-sm-6 text-end">
				<p class="mb-0 fw-bold fs-3">29200 Brest</p>
				<p class="mb-0">{{ datetime.date }} {{ datetime.heure }}</p>
				<p class="mb-0"></p>
			</div>
		</div>
	</div>

	<!--------------------------------------------------------------------------------------------------->


	<div class="bg-light p-4 m-5 shadow rounded">

		<div class="text-center">
			<p class="fw-bold fs-2">Les statistiques des douze mois écoulés</p>
			<figcaption class="blockquote-footer"></figcaption>
		</div>

		<form id="form1">
			<div class="row p-3 justify-content-center">

				<div class="col-sm-auto">
					<input type="radio" class="btn-check" name="chart-rd1" id="btn1" value="1" checked>
					<label class="btn btn-outline-secondary" for="btn1">Line graph</label>
				</div>
				<div class="col-sm-auto">
					<input type="radio" class="btn-check" name="chart-rd1" id="btn2" value="2">
					<label class="btn btn-outline-secondary" for="btn2">Bar graph</label>
				</div>
				<div class="col-sm-auto">
					<input type="checkbox" class="btn-check" name="chart-reg1" id="btn3">
					<label class="btn btn-outline-dark" for="btn3">Regression lineaire</label>
				</div>

			</div>
		</form>

		<div class="row p-4">
			<div class="col-sm-6 p-4">

				<div class="text-center">
					<p class="fw-bold fs-4">Température moyenne</p>
					<figcaption class="blockquote-footer"></figcaption>
				</div>

				<div class="text-center" id="chart1">
					<img class="img-fluid" src="data:image/png;base64, {{last_mounth.chart1|safe}}" alt="">
				</div>

			</div>
			<div class="col-sm-6 p-4">

				<div class="text-center">
					<p class="fw-bold fs-4">Précipitation moyenne</p>
					<figcaption class="blockquote-footer"></figcaption>
				</div>

				<div class="text-center" id="chart2">
					<img class="img-fluid" src="data:image/png;base64, {{last_mounth.chart2|safe}}" alt="">
				</div>

			</div>
		</div>
	</div>

	<!--------------------------------------------------------------------------------------------------->

	<div class="bg-light p-4 m-5 shadow rounded">

		<div class="text-center">
			<p class="fw-bold fs-2">les statistiques moyennes des douze mois de l'année depuis le 1er janvier 1850</p>
			<figcaption class="blockquote-footer"></figcaption>
		</div>

		<form id="form2">
			<div class="row">

				<div class="col-sm-4">

					<div class="row p-3 justify-content-start">

						<div class="col-sm-auto">
							<input type="radio" class="btn-check" name="chart-rd2" id="btn4" value="1" checked>
							<label class="btn btn-outline-secondary" for="btn4">Line graph</label>
						</div>
						<div class="col-sm-auto">
							<input type="radio" class="btn-check" name="chart-rd2" value="2" id="btn5">
							<label class="btn btn-outline-secondary" for="btn5">Bar graph</label>
						</div>
						<div class="col-sm-auto">
							<input type="checkbox" class="btn-check" name="chart-reg2" id="btn6">
							<label class="btn btn-outline-dark" for="btn6">Regression lineaire</label>
						</div>

					</div>

				</div>
				<div class="col-sm-4">

					<div class="row p-3 justify-content-end">

						<div class="col-sm-auto">
							<h3 class="fw-bold fs-4">Période</h3>
						</div>
						<div class="col-sm-auto">
							<select class="form-select" id="annee-selc-start" name="annee-start">
								{% for o in annee %}
								{% if o == 1980 %}
								<option value="{{o}}" selected>{{o}}</option>
								{% else %}
								<option value="{{o}}">{{o}}</option>
								{% endif %}
								{% endfor %}
							</select>
						</div>
						<div class="col-sm-auto">
							<h3 class="fw-bold fs-4">à</h3>
						</div>
						<div class="col-sm-auto">
							<select class="form-select" id="annee-selc-end" name="annee-end">
								{% for o in annee %}
								{% if o == 2021 %}
								<option value="{{o}}" selected>{{o}}</option>
								{% else %}
								<option value="{{o}}">{{o}}</option>
								{% endif %}
								{% endfor %}
							</select>
						</div>

					</div>

				</div>
				<div class="col-sm-4">

					<div class="row p-3 justify-content-end">

						<div class="col-sm-auto">
							<h3 class="fw-bold fs-4">Mois</h3>
						</div>
						<div class="col-sm-auto">
							<select class="form-select" id="mois-selc" name="mois">
								<option value="0" selected>Janvier</option>
								<option value="1">Fevrier</option>
								<option value="2">Mars</option>
								<option value="3">Avril</option>
								<option value="4">Mai</option>
								<option value="5">Juin</option>
								<option value="6">Juillet</option>
								<option value="7">Aout</option>
								<option value="8">Septembre</option>
								<option value="9">Octobre</option>
								<option value="10">Novembre</option>
								<option value="11">Decembre</option>
							</select>
						</div>

					</div>

				</div>

			</div>
		</form>

		<div class="row p-4">
			<div class="col-sm-6 p-4">

				<div class="text-center">
					<span id="title1">
						<p class="fw-bold fs-4">Température moyenne (janvier)</p>
					</span>
					<figcaption class="blockquote-footer"></figcaption>
				</div>

				<div class="text-center" id="chart3">
					<img class="img-fluid" src="data:image/png;base64, {{mounth.chart3|safe}}" alt="">
				</div>

			</div>
			<div class="col-sm-6 p-4">

				<div class="text-center">
					<span id="title2">
						<p class="fw-bold fs-4">Précipitation moyenne (janvier)</p>
					</span>
					<figcaption class="blockquote-footer"></figcaption>
				</div>

				<div class="text-center" id="chart4">
					<img class="img-fluid" src="data:image/png;base64, {{mounth.chart4|safe}}" alt="">
				</div>

			</div>
		</div>
	</div>

	<!--------------------------------------------------------------------------------------------------->

	<div class="bg-dark p-2 text-center">
		<p class="text-white mb-0">AIT ABDELKRIM Anass - BENAYADA Yasmina</p>
	</div>

	<!--------------------------------------------------------------------------------------------------->

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8"
		crossorigin="anonymous"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

	<script>

		$('#form1 input').on('change', function (event) {
			event.preventDefault();

			var reg = 0;
			var y = $('input[name=chart-reg1]:checked', '#form1').length;
			if (y > 0) {
				reg = 1;
			}
			var type = $('input[name=chart-rd1]:checked', '#form1').val();

			$.ajax({
				url: '/getchart/',
				type: 'GET',
				data: { type: type, reg: reg },
				success: function (response) {
					m = JSON.parse(response);
					$('#chart1').empty();
					$('#chart2').empty();
					$('#chart1').append('<img class="img-fluid" src="data:image/png;base64, ' + m.chart1 + '">');
					$('#chart2').append('<img class="img-fluid" src="data:image/png;base64, ' + m.chart2 + '">');
				}
			});
		});


		/* ******************************************************************************** */

		$('#form2').on('change', function (event) {
			event.preventDefault();

			var reg = 0;
			var y = $('input[name=chart-reg2]:checked', '#form2').length;
			if (y > 0) {
				reg = 1;
			}

			$('#title1').empty();
			$('#title2').empty();
			$('#title1').append('<p class="fw-bold fs-4">Température moyenne (' + $('#mois-selc option:selected').text() + ')</p>');
			$('#title2').append('<p class="fw-bold fs-4">Précipitation moyenne (' + $('#mois-selc option:selected').text() + ')</p>');

			var type = $('input[name=chart-rd2]:checked', '#form2').val();

			$.ajax({
				url: '/getchart2/',
				type: 'GET',
				data: { type: type, reg: reg, mois: $('#mois-selc option:selected').val(), annee_start: $('#annee-selc-start option:selected').val(), annee_end: $('#annee-selc-end option:selected').val() },
				success: function (response) {
					m = JSON.parse(response);

					$('#chart3').empty();
					$('#chart4').empty();
					$('#chart3').append('<img class="img-fluid" src="data:image/png;base64, ' + m.chart3 + '">');
					$('#chart4').append('<img class="img-fluid" src="data:image/png;base64, ' + m.chart4 + '">');
				}
			});
		});

	</script>

</body>

</html>